<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Test - Nostromo Monitoring System</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/terminal.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #00ff41;
            font-family: 'Courier New', monospace;
        }
        .test-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 10001;
            background: rgba(0, 0, 0, 0.9);
            padding: 10px;
            border: 1px solid #00ff41;
            max-width: 200px;
        }
        .test-controls button {
            background: #000;
            color: #00ff41;
            border: 1px solid #00ff41;
            padding: 5px 10px;
            margin: 2px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            width: 100%;
        }
        .test-controls button:hover {
            background: #00ff41;
            color: #000;
        }
        .test-controls h3 {
            margin: 0 0 10px 0;
            font-size: 12px;
        }
        #test-status {
            font-size: 10px;
            margin-top: 10px;
            color: #00cc33;
        }
    </style>
</head>
<body>
    <div class="test-controls">
        <h3>Navigation Test</h3>
        <button onclick="refreshMap()">Refresh Map</button>
        <button onclick="moveShip()">Move Ship</button>
        <button onclick="toggleGrid()">Toggle Grid</button>
        <button onclick="zoomIn()">Zoom In</button>
        <button onclick="zoomOut()">Zoom Out</button>
        <div id="test-status">Navigation system ready</div>
    </div>

    <!-- Main Terminal Container -->
    <div id="terminal-container" class="app-container">
        <!-- Terminal Header -->
        <header class="terminal-header">
            <div class="system-title">USCSS Nostromo - Navigation Test</div>
            <div class="system-status">
                STELLAR CARTOGRAPHY | <span id="system-time"></span> | STATUS: <span class="status-ok">OPERATIONAL</span>
            </div>
        </header>

        <!-- Navigation Screen -->
        <div id="navigation-screen" class="screen active">
            <div class="screen-header">
                <h2>NAVIGATION & POSITIONING</h2>
                <div class="breadcrumb">MAIN > NAVIGATION</div>
            </div>
            <div class="screen-content">
                <!-- Navigation content will be populated by JavaScript -->
                <div class="loading-message">
                    <span>LOADING NAVIGATION SYSTEMS...</span>
                    <span class="cursor">_</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/data-simulator.js"></script>
    <script src="js/navigation.js"></script>
    <script>
        let navigation;
        let dataSimulator;
        let testStatus = document.getElementById('test-status');
        let shipPosition = { x: 0, y: 0, z: 0 };

        // Initialize system time
        function updateSystemTime() {
            const timeElement = document.getElementById('system-time');
            if (timeElement) {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                const timeString = `2122-06-02 ${hours}:${minutes}:${seconds}`;
                timeElement.textContent = timeString;
            }
        }

        // Initialize navigation system
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize data simulator
            if (typeof DataSimulator !== 'undefined') {
                dataSimulator = new DataSimulator();
                console.log('Data simulator initialized');
            }

            // Initialize navigation system
            if (typeof NostromoNavigation !== 'undefined' && dataSimulator) {
                navigation = new NostromoNavigation(dataSimulator);
                navigation.activate();
                console.log('Navigation system initialized');
                testStatus.textContent = 'Navigation system active';
            } else {
                console.error('Navigation system or DataSimulator not available');
                testStatus.textContent = 'ERROR: System not available';
            }

            // Start system time updates
            updateSystemTime();
            setInterval(updateSystemTime, 1000);
        });

        // Test functions
        function refreshMap() {
            if (navigation) {
                navigation.render();
                testStatus.textContent = 'Star map refreshed';
            }
        }

        function moveShip() {
            if (dataSimulator) {
                // Simulate ship movement
                shipPosition.x += (Math.random() - 0.5) * 1000;
                shipPosition.y += (Math.random() - 0.5) * 1000;
                shipPosition.z += (Math.random() - 0.5) * 100;
                
                // Update navigation data
                navigation.updateNavigationData();
                testStatus.textContent = `Ship moved to ${shipPosition.x.toFixed(1)}, ${shipPosition.y.toFixed(1)}`;
            }
        }

        function toggleGrid() {
            const starField = document.querySelector('.star-field');
            if (starField) {
                starField.classList.toggle('no-grid');
                testStatus.textContent = 'Grid toggled';
            }
        }

        function zoomIn() {
            const starField = document.querySelector('.star-field');
            if (starField) {
                const currentSize = parseFloat(getComputedStyle(starField).fontSize);
                starField.style.fontSize = (currentSize + 1) + 'px';
                testStatus.textContent = `Zoomed in: ${currentSize + 1}px`;
            }
        }

        function zoomOut() {
            const starField = document.querySelector('.star-field');
            if (starField) {
                const currentSize = parseFloat(getComputedStyle(starField).fontSize);
                if (currentSize > 6) {
                    starField.style.fontSize = (currentSize - 1) + 'px';
                    testStatus.textContent = `Zoomed out: ${currentSize - 1}px`;
                }
            }
        }

        // Add some CSS for grid toggle
        const style = document.createElement('style');
        style.textContent = `
            .star-field.no-grid {
                color: var(--terminal-green-bright);
            }
            .star-field.no-grid .star-point {
                color: var(--terminal-green-bright);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>