class NostromoCrew{constructor(dataSimulator){this.dataSimulator=dataSimulator,this.refreshInterval=null,this.refreshRate=3e3,this.isActive=!1,this.selectedCrewMember=null,this.alertThresholds=this.initializeAlertThresholds(),this.shipLayout=this.initializeShipLayout(),this.quartersEnvironment=this.initializeQuartersEnvironment(),this.init()}init(){console.log("Crew monitoring system initialized")}initializeAlertThresholds(){return{heartRate:{warningLow:60,warningHigh:100,criticalLow:50,criticalHigh:120},temperature:{warningLow:36,warningHigh:37.5,criticalLow:35,criticalHigh:38.5},oxygenSat:{warning:95,critical:90}}}initializeShipLayout(){return{BRIDGE:{x:2,y:1,symbol:"[B]"},ENGINEERING:{x:1,y:3,symbol:"[E]"},QUARTERS:{x:3,y:2,symbol:"[Q]"},NAVIGATION:{x:2,y:0,symbol:"[N]"},MAINTENANCE:{x:0,y:2,symbol:"[M]"},SCIENCE:{x:4,y:1,symbol:"[S]"},CARGO:{x:2,y:4,symbol:"[C]"}}}initializeQuartersEnvironment(){return{CREW_A:{name:"QUARTERS A",occupant:"DALLAS"},CREW_B:{name:"QUARTERS B",occupant:"RIPLEY"},CREW_C:{name:"QUARTERS C",occupant:"KANE"},CREW_D:{name:"QUARTERS D",occupant:"LAMBERT"},CREW_E:{name:"QUARTERS E",occupant:"BRETT"},CREW_F:{name:"QUARTERS F",occupant:"PARKER"},CREW_G:{name:"QUARTERS G",occupant:"ASH"}}}activate(){this.isActive=!0,this.render(),this.startRealTimeUpdates(),console.log("Crew monitoring activated")}deactivate(){this.isActive=!1,this.stopRealTimeUpdates(),console.log("Crew monitoring deactivated")}startRealTimeUpdates(){this.refreshInterval&&clearInterval(this.refreshInterval),this.refreshInterval=setInterval(()=>{this.isActive&&this.updateData()},this.refreshRate)}stopRealTimeUpdates(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null)}render(){const crewScreen=document.getElementById("crew-screen");if(!crewScreen)return void console.error("Crew screen element not found");const screenContent=crewScreen.querySelector(".screen-content");screenContent?(screenContent.innerHTML=this.generateCrewHTML(),this.updateData(),this.initializeEventListeners()):console.error("Crew screen content not found")}generateCrewHTML(){return`\n            <div class="crew-container">\n                \x3c!-- Personnel Roster --\x3e\n                <div class="personnel-section">\n                    <div class="section-header">PERSONNEL ROSTER</div>\n                    <div class="crew-roster" id="crew-roster">\n                        ${this.generateCrewRosterHTML()}\n                    </div>\n                </div>\n\n                \x3c!-- Ship Layout with Crew Positions --\x3e\n                <div class="location-section">\n                    <div class="section-header">CREW LOCATION TRACKING</div>\n                    <div class="ship-schematic" id="ship-schematic">\n                        ${this.generateShipSchematicHTML()}\n                    </div>\n                    <div class="location-legend">\n                        <div class="legend-item">[B] BRIDGE</div>\n                        <div class="legend-item">[E] ENGINEERING</div>\n                        <div class="legend-item">[Q] QUARTERS</div>\n                        <div class="legend-item">[N] NAVIGATION</div>\n                        <div class="legend-item">[M] MAINTENANCE</div>\n                        <div class="legend-item">[S] SCIENCE</div>\n                        <div class="legend-item">[C] CARGO</div>\n                    </div>\n                </div>\n\n                \x3c!-- Vital Signs Monitoring --\x3e\n                <div class="vitals-section">\n                    <div class="section-header">VITAL SIGNS MONITORING</div>\n                    <div class="vitals-display" id="vitals-display">\n                        ${this.generateVitalsHTML()}\n                    </div>\n                </div>\n\n                \x3c!-- Quarters Environmental Data --\x3e\n                <div class="quarters-section">\n                    <div class="section-header">QUARTERS ENVIRONMENTAL STATUS</div>\n                    <div class="quarters-grid" id="quarters-grid">\n                        ${this.generateQuartersHTML()}\n                    </div>\n                </div>\n\n                \x3c!-- Crew Alerts --\x3e\n                <div class="crew-alerts-section">\n                    <div class="section-header">\n                        CREW ALERTS\n                        <span class="alert-count" id="crew-alert-count">0</span>\n                    </div>\n                    <div class="crew-alert-panel" id="crew-alert-panel">\n                        <div class="no-alerts">NO ACTIVE CREW ALERTS</div>\n                    </div>\n                </div>\n            </div>\n        `}generateCrewRosterHTML(){if(!this.dataSimulator)return'<div class="loading-message">DATA SIMULATOR NOT AVAILABLE</div>';return this.dataSimulator.generateCrewData().map(member=>`\n            <div class="crew-member" id="crew-${member.id}" data-crew-id="${member.id}">\n                <div class="crew-header">\n                    <span class="crew-name">${member.name}</span>\n                    <span class="crew-status status-${member.status}">${member.status.toUpperCase()}</span>\n                </div>\n                <div class="crew-details">\n                    <div class="crew-location">\n                        <span class="detail-label">LOCATION:</span>\n                        <span class="detail-value" id="crew-${member.id}-location">${member.location}</span>\n                    </div>\n                    <div class="crew-vitals-summary">\n                        <span class="vital-item">\n                            HR: <span id="crew-${member.id}-hr">${member.vitals.heartRate}</span>\n                        </span>\n                        <span class="vital-item">\n                            TEMP: <span id="crew-${member.id}-temp">${member.vitals.temperature.toFixed(1)}°C</span>\n                        </span>\n                        <span class="vital-item">\n                            O2: <span id="crew-${member.id}-o2">${member.vitals.oxygenSat}%</span>\n                        </span>\n                    </div>\n                </div>\n                <div class="crew-indicator" id="crew-${member.id}-indicator">●</div>\n            </div>\n        `).join("")}generateShipSchematicHTML(){return'\n            <div class="schematic-display">\n                <pre class="ship-layout">\n╔═══════════════════════════════════════╗\n║              USCSS NOSTROMO           ║\n╠═══════════════════════════════════════╣\n║                                       ║\n║     [N]           [B]           [S]   ║\n║      │             │             │    ║\n║   ┌──┴──┐       ┌──┴──┐       ┌──┴──┐ ║\n║   │ NAV │───────│BRDG │───────│ SCI │ ║\n║   └─────┘       └─────┘       └─────┘ ║\n║                                       ║\n║ [M]               [Q]                 ║\n║  │                 │                  ║\n║┌─┴─┐             ┌─┴─┐                ║\n║│MNT│─────────────│QTR│                ║\n║└───┘             └───┘                ║\n║                                       ║\n║     [E]                               ║\n║      │                                ║\n║   ┌──┴──┐                             ║\n║   │ ENG │                             ║\n║   └─────┘                             ║\n║                                       ║\n║                 [C]                   ║\n║                  │                    ║\n║               ┌──┴──┐                 ║\n║               │CRGO │                 ║\n║               └─────┘                 ║\n║                                       ║\n╚═══════════════════════════════════════╝\n                </pre>\n                <div class="crew-positions" id="crew-positions">\n                    \x3c!-- Crew positions will be updated dynamically --\x3e\n                </div>\n            </div>\n        '}generateVitalsHTML(){return'\n            <div class="vitals-grid">\n                <div class="vitals-chart" id="vitals-chart">\n                    <div class="chart-title">CREW VITAL SIGNS OVERVIEW</div>\n                    <div class="vitals-table" id="vitals-table">\n                        \x3c!-- Vitals table will be populated dynamically --\x3e\n                    </div>\n                </div>\n                <div class="selected-crew-vitals" id="selected-crew-vitals">\n                    <div class="selected-title">SELECT CREW MEMBER FOR DETAILED VITALS</div>\n                    <div class="detailed-vitals" id="detailed-vitals">\n                        \x3c!-- Detailed vitals will be shown when crew member is selected --\x3e\n                    </div>\n                </div>\n            </div>\n        '}generateQuartersHTML(){return Object.entries(this.quartersEnvironment).map(([quarterId,quarters])=>`\n            <div class="quarters-item" id="quarters-${quarterId.toLowerCase()}">\n                <div class="quarters-header">\n                    <span class="quarters-name">${quarters.name}</span>\n                    <span class="quarters-occupant">${quarters.occupant}</span>\n                </div>\n                <div class="quarters-env">\n                    <div class="env-metric">\n                        <span class="env-label">TEMP:</span>\n                        <span class="env-value" id="quarters-${quarterId.toLowerCase()}-temp">--°C</span>\n                    </div>\n                    <div class="env-metric">\n                        <span class="env-label">O2:</span>\n                        <span class="env-value" id="quarters-${quarterId.toLowerCase()}-oxygen">--%</span>\n                    </div>\n                    <div class="env-metric">\n                        <span class="env-label">PRESS:</span>\n                        <span class="env-value" id="quarters-${quarterId.toLowerCase()}-pressure">-- ATM</span>\n                    </div>\n                    <div class="quarters-indicator" id="quarters-${quarterId.toLowerCase()}-indicator">●</div>\n                </div>\n            </div>\n        `).join("")}initializeEventListeners(){document.querySelectorAll(".crew-member").forEach(member=>{member.addEventListener("click",e=>{const crewId=member.dataset.crewId;this.selectCrewMember(crewId)})})}selectCrewMember(crewId){const previousSelected=document.querySelector(".crew-member.selected");previousSelected&&previousSelected.classList.remove("selected");const selectedMember=document.getElementById(`crew-${crewId}`);selectedMember&&(selectedMember.classList.add("selected"),this.selectedCrewMember=crewId,this.updateDetailedVitals(crewId))}updateData(){if(!this.dataSimulator)return void console.warn("Data simulator not available");const systemData=this.dataSimulator.generateSystemStatus(),crewData=systemData.crew,lifeSupportData=systemData.lifeSupport;this.updateCrewRoster(crewData),this.updateCrewPositions(crewData),this.updateVitalsTable(crewData),this.updateQuartersEnvironment(lifeSupportData),this.selectedCrewMember&&this.updateDetailedVitals(this.selectedCrewMember),this.updateCrewAlerts(crewData)}updateCrewRoster(crewData){const rosterContainer=document.getElementById("crew-roster");rosterContainer&&crewData&&(rosterContainer.innerHTML=crewData.map(member=>`\n                <div class="crew-member" id="crew-${member.id}" data-crew-id="${member.id}">\n                    <div class="crew-header">\n                        <span class="crew-name">${member.name}</span>\n                        <span class="crew-status status-${member.status}">${member.status.toUpperCase()}</span>\n                    </div>\n                    <div class="crew-details">\n                        <div class="crew-location">\n                            <span class="detail-label">LOCATION:</span>\n                            <span class="detail-value">${member.location}</span>\n                        </div>\n                        <div class="crew-vitals-summary">\n                            <span class="vital-item">\n                                HR: <span>${member.vitals.heartRate}</span>\n                            </span>\n                            <span class="vital-item">\n                                TEMP: <span>${member.vitals.temperature.toFixed(1)}°C</span>\n                            </span>\n                            <span class="vital-item">\n                                O2: <span>${member.vitals.oxygenSat}%</span>\n                            </span>\n                        </div>\n                    </div>\n                    <div class="crew-indicator ${this.getCrewHealthStatus(member.vitals)}">●</div>\n                </div>\n            `).join(""),this.initializeEventListeners())}updateCrewPositions(crewData){const positionsContainer=document.getElementById("crew-positions");if(!positionsContainer)return;const positionMarkers=crewData.map(member=>{const layout=this.shipLayout[member.location];return layout?`\n                <div class="crew-position" \n                     style="grid-column: ${layout.x+1}; grid-row: ${layout.y+1};"\n                     title="${member.name} - ${member.location}">\n                    ${member.name.charAt(0)}\n                </div>\n            `:""}).join("");positionsContainer.innerHTML=positionMarkers}updateVitalsTable(crewData){const vitalsTable=document.getElementById("vitals-table");if(!vitalsTable)return;const tableHTML=`\n            <table class="crew-vitals-table">\n                <thead>\n                    <tr>\n                        <th>CREW MEMBER</th>\n                        <th>HEART RATE</th>\n                        <th>TEMPERATURE</th>\n                        <th>OXYGEN SAT</th>\n                        <th>STATUS</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ${crewData.map(member=>`\n                        <tr class="vitals-row ${this.getCrewHealthStatus(member.vitals)}">\n                            <td class="crew-name-cell">${member.name}</td>\n                            <td class="vitals-cell">${member.vitals.heartRate} BPM</td>\n                            <td class="vitals-cell">${member.vitals.temperature.toFixed(1)}°C</td>\n                            <td class="vitals-cell">${member.vitals.oxygenSat}%</td>\n                            <td class="status-cell">${this.getVitalsStatusText(member.vitals)}</td>\n                        </tr>\n                    `).join("")}\n                </tbody>\n            </table>\n        `;vitalsTable.innerHTML=tableHTML}updateDetailedVitals(crewId){if(!this.dataSimulator)return;const selectedMember=this.dataSimulator.generateCrewData().find(member=>member.id===crewId);if(!selectedMember)return;const detailedVitals=document.getElementById("detailed-vitals");if(!detailedVitals)return;const vitals=selectedMember.vitals,status=this.getCrewHealthStatus(vitals);detailedVitals.innerHTML=`\n            <div class="detailed-crew-info">\n                <div class="detailed-header">\n                    <span class="detailed-name">${selectedMember.name}</span>\n                    <span class="detailed-status ${status}">${this.getVitalsStatusText(vitals)}</span>\n                </div>\n                <div class="detailed-metrics">\n                    <div class="detailed-metric">\n                        <div class="metric-label">HEART RATE</div>\n                        <div class="metric-value ${this.getVitalStatus("heartRate",vitals.heartRate)}">\n                            ${vitals.heartRate} BPM\n                        </div>\n                        <div class="metric-bar">\n                            ${this.generateVitalBar("heartRate",vitals.heartRate)}\n                        </div>\n                    </div>\n                    <div class="detailed-metric">\n                        <div class="metric-label">BODY TEMPERATURE</div>\n                        <div class="metric-value ${this.getVitalStatus("temperature",vitals.temperature)}">\n                            ${vitals.temperature.toFixed(1)}°C\n                        </div>\n                        <div class="metric-bar">\n                            ${this.generateVitalBar("temperature",vitals.temperature)}\n                        </div>\n                    </div>\n                    <div class="detailed-metric">\n                        <div class="metric-label">OXYGEN SATURATION</div>\n                        <div class="metric-value ${this.getVitalStatus("oxygenSat",vitals.oxygenSat)}">\n                            ${vitals.oxygenSat}%\n                        </div>\n                        <div class="metric-bar">\n                            ${this.generateVitalBar("oxygenSat",vitals.oxygenSat)}\n                        </div>\n                    </div>\n                </div>\n                <div class="crew-location-detail">\n                    <div class="location-label">CURRENT LOCATION</div>\n                    <div class="location-value">${selectedMember.location}</div>\n                    <div class="activity-label">ACTIVITY STATUS</div>\n                    <div class="activity-value">${selectedMember.status.toUpperCase()}</div>\n                </div>\n            </div>\n        `}generateVitalBar(vitalType,value){const range={heartRate:{min:50,max:120,normal:[60,100]},temperature:{min:35,max:38.5,normal:[36,37.5]},oxygenSat:{min:90,max:100,normal:[95,100]}}[vitalType],percentage=(value-range.min)/(range.max-range.min)*100,status=this.getVitalStatus(vitalType,value),filledBars=Math.round(percentage/100*20),emptyBars=20-filledBars;return`\n            <div class="vital-bar ${status}">\n                <span class="bar-filled">${"█".repeat(filledBars)}</span><span class="bar-empty">${"░".repeat(emptyBars)}</span>\n            </div>\n        `}updateQuartersEnvironment(lifeSupportData){Object.keys(this.quartersEnvironment).forEach((quarterId,index)=>{const variation_temperature=2*(Math.random()-.5),variation_oxygen=3*(Math.random()-.5),variation_pressure=.02*(Math.random()-.5),quartersData={temperature:lifeSupportData.temperature+variation_temperature,oxygen:lifeSupportData.oxygen+variation_oxygen,pressure:lifeSupportData.pressure+variation_pressure},tempElement=document.getElementById(`quarters-${quarterId.toLowerCase()}-temp`),oxygenElement=document.getElementById(`quarters-${quarterId.toLowerCase()}-oxygen`),pressureElement=document.getElementById(`quarters-${quarterId.toLowerCase()}-pressure`),indicatorElement=document.getElementById(`quarters-${quarterId.toLowerCase()}-indicator`);if(tempElement&&(tempElement.textContent=`${quartersData.temperature.toFixed(1)}°C`),oxygenElement&&(oxygenElement.textContent=`${quartersData.oxygen.toFixed(1)}%`),pressureElement&&(pressureElement.textContent=`${quartersData.pressure.toFixed(2)} ATM`),indicatorElement){const status=this.getEnvironmentalStatus(quartersData);indicatorElement.className=`quarters-indicator ${status}`}})}getCrewHealthStatus(vitals){const statuses=[this.getVitalStatus("heartRate",vitals.heartRate),this.getVitalStatus("temperature",vitals.temperature),this.getVitalStatus("oxygenSat",vitals.oxygenSat)];return statuses.includes("status-critical")?"status-critical":statuses.includes("status-warning")?"status-warning":"status-ok"}getVitalStatus(vitalType,value){const thresholds=this.alertThresholds[vitalType];switch(vitalType){case"heartRate":case"temperature":return value<thresholds.criticalLow||value>thresholds.criticalHigh?"status-critical":value<thresholds.warningLow||value>thresholds.warningHigh?"status-warning":"status-ok";case"oxygenSat":return value<thresholds.critical?"status-critical":value<thresholds.warning?"status-warning":"status-ok";default:return"status-ok"}}getVitalsStatusText(vitals){switch(this.getCrewHealthStatus(vitals)){case"status-critical":return"CRITICAL";case"status-warning":return"WARNING";default:return"NORMAL"}}getEnvironmentalStatus(envData){return envData.temperature<18||envData.temperature>24||envData.oxygen<90?"status-warning":envData.temperature<16||envData.temperature>26||envData.oxygen<85?"status-critical":"status-ok"}updateCrewAlerts(crewData){const alerts=this.generateCrewAlerts(crewData),alertPanel=document.getElementById("crew-alert-panel"),alertCount=document.getElementById("crew-alert-count");alertPanel&&alertCount&&(alertCount.textContent=alerts.length.toString(),alertCount.className="alert-count "+(alerts.length>0?"has-alerts":""),0===alerts.length?alertPanel.innerHTML='<div class="no-alerts">NO ACTIVE CREW ALERTS</div>':alertPanel.innerHTML=alerts.map(alert=>`\n                <div class="alert-item ${alert.severity}">\n                    <span class="alert-icon">⚠</span>\n                    <span class="alert-message">${alert.message}</span>\n                    <span class="alert-time">${alert.time}</span>\n                </div>\n            `).join(""))}generateCrewAlerts(crewData){const alerts=[],currentTime=(new Date).toTimeString().substring(0,8);return crewData.forEach(member=>{const vitals=member.vitals;vitals.heartRate<this.alertThresholds.heartRate.criticalLow||vitals.heartRate>this.alertThresholds.heartRate.criticalHigh?alerts.push({severity:"alert-critical",message:`CRITICAL: ${member.name} HEART RATE ${vitals.heartRate} BPM - MEDICAL ATTENTION REQUIRED`,time:currentTime}):(vitals.heartRate<this.alertThresholds.heartRate.warningLow||vitals.heartRate>this.alertThresholds.heartRate.warningHigh)&&alerts.push({severity:"alert-warning",message:`WARNING: ${member.name} HEART RATE ${vitals.heartRate} BPM - MONITOR CLOSELY`,time:currentTime}),vitals.temperature<this.alertThresholds.temperature.criticalLow||vitals.temperature>this.alertThresholds.temperature.criticalHigh?alerts.push({severity:"alert-critical",message:`CRITICAL: ${member.name} TEMPERATURE ${vitals.temperature.toFixed(1)}°C - IMMEDIATE MEDICAL RESPONSE`,time:currentTime}):(vitals.temperature<this.alertThresholds.temperature.warningLow||vitals.temperature>this.alertThresholds.temperature.warningHigh)&&alerts.push({severity:"alert-warning",message:`WARNING: ${member.name} TEMPERATURE ${vitals.temperature.toFixed(1)}°C - CHECK CREW MEMBER`,time:currentTime}),vitals.oxygenSat<this.alertThresholds.oxygenSat.critical?alerts.push({severity:"alert-critical",message:`CRITICAL: ${member.name} OXYGEN SATURATION ${vitals.oxygenSat}% - OXYGEN SUPPORT NEEDED`,time:currentTime}):vitals.oxygenSat<this.alertThresholds.oxygenSat.warning&&alerts.push({severity:"alert-warning",message:`WARNING: ${member.name} OXYGEN SATURATION ${vitals.oxygenSat}% - MONITOR BREATHING`,time:currentTime})}),alerts}}"undefined"!=typeof module&&module.exports?module.exports=NostromoCrew:window.NostromoCrew=NostromoCrew;